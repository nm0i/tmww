.\" Text automatically generated by md2man 
.TH tmww 1 "November 28, 2014" "Linux" "Linux Reference Manual"
.SH NAME
\fBtmww \fP- The Mana World Watcher scripts
.PP
.SH SYNOPSIS
.nf
.fam C
\fBtmww\fP [\fB-vhpecbrsy\fP] [\fB-a\fP \fIACTION\fP] [\fB-d\fP \fIDELTA\fP] \fICONFIG\fP \fIOPTIONS\fP]]
.PP
.fam T
.fi
.SH \FBOVERVIEW\FP
\fBtmww\fP (The Mana World Watcher) is POSIX compliant shell script performing
miscellaneous subsidiary tasks on tmwa online player list and other game data.
Typical usage includes online list pretty print, notifications if friends are
online and logging of players online presence.
.PP
.SH OPTIONS
.TP
.B
\fB-v\fP
print version and exit
.TP
.B
\fB-h\fP
print command line options help and exit
.TP
.B
\fB-p\fP
list available plugins and exit
.TP
.B
\fB-g\fP
output config variable; e.g. "TMWW_PLUGINPATH=test \fBtmww\fP \fB-g\fP PLUGINPATH"
.TP
.B
\fB-u\fP
disallow reusing external variables, e.g. "TMWW_PLUGINPATH=test \fBtmww\fP \fB-ug\fP PLUGINPATH"
.TP
.B
\fB-z\fP
dump aliases from zsh completions and exit
.TP
.B
\fB-e\fP
output executed plugin names and exit error codes - override VERBOSE; set to "yes"
.TP
.B
\fB-c\fP
black & white - override COLORS; set to "no"
.TP
.B
\fB-b\fP
unset bold text attribute for service messages - override HIGHLIGHT; set to "no"
.TP
.B
\fB-r\fP
override RING; set to "yes"
.TP
.B
\fB-s\fP
override RING; set to "no"
.TP
.B
\fB-y\fP
override DRYRUN; set to "yes"
.TP
.B
\fB-f\fP
override DRYRUN (set to "no") and run "fetch" action before anything else
.TP
.B
\fB-a\fP \fIACTION\fP
override CMDACTION;
options \fB-h\fP and \fB-v\fP after specified action will display help/version for this action
.TP
.B
\fB-d\fP \fIDELTA\fP
override \fIDELTA\fP for downloading players list
delta is delay in seconds from last download allowed to skip update
.TP
.B
\fICONFIG\fP
first tried from currend directory, if not found - tried with .conf
extension in DIRCONFIG
.PP
Example calls:
.PP
.nf
.fam C
    $ tmww -h
    $ tmww -p
    $ tmww -a alts -h
    $ tmww average -h
    $ tmww -a activity tmw.org average -p ginaria -rsd10
    $ watch tmww -ra watch -d 16 tmw.org
.fam T
.fi
.PP
.SH DESCRIPTION
\fBtmww\fP itself does nothing and serves as wrapper for *plugins*. Plugins performs
*actions*. Each \fBtmww\fP instance is allowed to perform multiple actions described
in config section "actions". Config file may define default CLI action which
will recieve all extra command line arguments. Default action may be overridden
with _\fB-a_\fP option.
.PP
Plugins will print available command line options when "\fB-h\fP" key is given after "\fB-a\fP action" like:
.PP
.nf
.fam C
    $ tmww -a alts -h
.fam T
.fi
.PP
Help will be displayed when first option after config is "\fB-h\fP" with configs with
predefined command line action.
.SS Online list parsers
Online list parsers are autoselected depending on online list (referenced by
\fILINK\fP config option) extension: \fI.txt\fP and \fI.html\fP . \fBtmww\fP should be upgraded
each time online list format is changed.
.SS Running multiple tmww instances
Multiple \fBtmww\fP instances usually reuse online list. Options solving conflicts
between multiple instances are \fIDELTA\fP, INSTANCE and DRYRUN. Even so \fBtmww\fP will
make use of lock to prevent other instances from running at same time.
.PP
\fIDELTA\fP is delay in seconds from last download allowed to skip update (delta =
current epoch seconds - online list modification epoch seconds). Delta variable
make sense for multiple \fBtmww\fP instances running/scheduled (e.g. watch and
notify, so notify with large delta can reuse link downloaded by watch instance
and load it in case watch was not running).
.PP
Typical times to reference: fetch default timeout is set to 9 seconds,
server.themanaworld.org online list updates every 20 seconds, per server lock
file abandon delay is hard coded to 10 seconds.
.PP
INSTANCE for instances making use of logon/logoff lists and runned with
different \fIDELTA\fP should be different, so e.g. notify instance running every 15
mins will not generate/make incorrect logon/logoff events using same old online
list copy as watch instance running every 5 minutes. When shared online list is
stored in TMP folder, instance temp files are stored in PRIVTMP.
.SS Temporary folders
There are two temporary folders required: TMP and PRIVTMP. First is used as
shared folder between users and instances, most often storing online list. All
files as folder itself are RW for all. PRIVTMP is where personal "old" copies
of online lists are stored, where lists compiled and so on. Shared TMP can be
also use e.g. for LOCK and DBLOCK with restricted multiuser access.
.PP
Default shared TMP folder contents:
.TP
.B
\fBtmww\fP-_servername_-raw
raw txt/html file. One per \fIservername\fP
.TP
.B
\fBtmww\fP-_servername_-online
parsed list with char name per line. One per \fIservername\fP
.TP
.B
\fBtmww\fP-_servername_-gm
gm list extracted from online list
.TP
.B
\fBtmww\fP-_servername_-online.INSTANCE
example name convention of copy of parsed online list
for generating logon/logoff lists
.TP
.B
\fBtmww\fP-_servername_-logon
logon events for current running instance
.TP
.B
\fBtmww\fP-_servername_-logoff
logoff char names for current instance
.PP
Default shipping contains example raw online lists.
.SS Dryrun
DRYRUN config option will prevent online list fetching and modification of
logon/logoff lists generated from online list copy referenced by INSTANCE
variable; in other words DRYRUN prevents "fetch" action (this action is
responsible for logon/logoff lists generation, backuping and so on).
.PP
Use cases:
.IP \(bu 3
situation when you monitor \fBtmww\fP watch" instance and want to run another
\fBtmww\fP watch" instance with different settings but not corrupting main
logon/logoff reporting.
.IP \(bu 3
debug case: dry run will not fetch online list every time you fire \fBtmww\fP
instance and will not touch logon/logoff lists
.IP \(bu 3
some plugins only reuse path settings from config and require no online list
at all
.PP
NOTE: DRYRUN may not be supported by plugins fetching additional data on each
run
.PP
Opposite to \fB-y\fP option \fB-f\fP will force "fetch" action before any other action take
place.
.SS Dependencies
Plugins may define other recommended plugins or dependency plugins. Conflicts
are not resolved automatically. No warnings with conflicting plugins are
displayed. No plugin version checked. All potentially conflicting plugins
should be resolved by hand - not running them simultaneously/on common target.
.PP
Example of conflicting plugins: versions and log. Both will duplicate
logon/logoff events and have possibility of simultaneous write to log.
.SS Utils
Plugins can refer to utils which are searched inside /path/to/config/utils/.
Util path is also used as storage for internal configs and data files.
.PP
.SH FILES
.TP
.B
~/.config\fBtmww\fP/*.conf
default path to configs;
overridden from env with DIRCONFIG
.TP
.B
~/.config\fBtmww\fP/plugins/*.plugin
plugins; used with \fBtmww\fP \fB-a\fP , CMDACTION or in action section
overridden with PLUGINPATH
.TP
.B
~/.config\fBtmww\fP/plugins/*.lib.sh
functions shared between plugins
.TP
.B
~/.config\fBtmww\fP/plugins/*.zsh
completion code for plugin/config script; auto-included with OMZ plugin;
.PP
~/.config\fBtmww\fP/utils/
scripts and misc files/lists/configs reused between plugins and users;
overridden with UTILPATH
.PP
.SH BUGS
All shell-related precautions apply here. Plugin-specific bugs covered in
plugin manuals.
.PP
.SH COPYRIGHT
This document is part of \fBtmww\fP - The Mana World Watcher scripts.
.PP
Licensed under terms of GNU General Public License version 3. For full text of
license see COPYING file distributed with \fBtmww\fP.
.PP
.SH AUTHORS
willee <v4r@trioptimum.com>, 2012-2014
.PP
.SH SEE ALSO
\fBtmww-versionlog\fP(1), \fBtmww\fP-versiontable(1), \fBtmww-activity\fP(1), \fBtmww-alts\fP(1),
\fBtmww-server\fP(1), \fBtmww-accsniffer\fP(1), \fBtmww-client\fP(1), \fBtmww-watch\fP(1),
\fBtmww\fP-db(1), \fBtmww-server\fP(1)
.TP
.B
\fBtmww-config\fP(5)
default config, single/multiuser configuration notes
.TP
.B
\fBtmww\fP-plugin(7)
how to write plugin
.TP
.B
\fBtmww-zsh\fP(7)
completion details
