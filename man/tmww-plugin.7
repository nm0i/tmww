.\" Text automatically generated by md2man 
.TH tmww-plugin 7 "October 11, 2014" "Linux" "Linux Reference Manual"
.SH NAME
\fBtmww \fP- plugins extensibility guide
.PP
.PP
.SH DESCRIPTION
.SS Plugins
All plugins try to use UTC time, server time assumed to be the same.
.PP
.PP
Plugins utilize functions and variables provided by tmww. Functions recommended
to utilize reside in "common routines" tmww section. Examples of reused variables are:
.PP
.IP \(bu 3
system variables like _$FETCH_, \fI$AWK\fP and so on
.IP \(bu 3
$servertime, $servername, _$list\_logon_, _$list\_logoff_, \fI$list\_online\fP and autoupdate lists like \fI$list\_gm\fP
.IP \(bu 3
color variables like \fI$color\_green\fP and \fI$color\_red\fP (see notes on using color)
.PP
.PP
Lot of plugins data is expected to have per-server structure. Server name
accessible by \fI$servername\fP variable is usually determined from online list
variable \fILINK\fP but could be overriden with _SERVERNAME_.
.PP
.SS Writing plugins
Plugin contains recommended lines available for simple grep, like _conflict_,
_depends_, _recommend_, _whatis_. Plugins should parse command line parameters
themself. Error/warning messages are printed to stderr. Exit from plugin made
only over "return" possibly with return code. Return code > 0 is treated as
error.
.PP
.PP
Recommended behavior for plugins working with lists - just skip/silently ignore
lines with disallowed chars like double quotes or colon to avoid future
conflicts.
.PP
.PP
Plugins using logon/logoff events from auto lists like GM should handle copying
such lists theirselves See instances explanation in \fBtmww-config\fP(5).
.PP
.PP
Make sure you don't build variable names with prefix/suffix so they could be
wrong recognized or use ${} form. Use expand_path to validate path and expand
tilde. If you don't validate integers don't forget to redirect error messages,
like:
.PP
.PP
.nf
.fam C
    [ "$TMWW_INTEGER" -ne 0 2>/dev/null ] && echo $TMWW_INTEGER
.fam T
.fi
.PP
.TP
.B
IMPORTANT:
make sure you clear variables starting actions - this is required
for custom scripts using plugins with runaction
.PP
.SS Standart facilities
See tmww source for implementatio details and existing plugins for usage
examples.
.PP
.PP
Functions:
.PP
.IP \(bu 3
verbose, warning, error, error_params (and derived), check_string_chars
.IP \(bu 3
comm_23, comm_12, make_csv, make_qcsv
.IP \(bu 3
check_lock - sets trap on lock dir
.IP \(bu 3
trap_add
.IP \(bu 3
check_dir
.IP \(bu 3
requireplugin
.IP \(bu 3
runaction (see example in inspect.conf)
.IP \(bu 3
process_section
.PP
.PP
Variables:
.PP
.IP \(bu 3
highlight and color definitions
.IP \(bu 3
err_flag (set from error function)
.IP \(bu 3
uniqifs, backifs
.IP \(bu 3
configdata (set from process_section)
.IP \(bu 3
plugin_options (options passes to plugin on command line or with runaction)
.IP \(bu 3
servername
.IP \(bu 3
lists - list_raw and so on
.PP
.PP
When reusing plugins functions, "func_" prefixed functions should be used
instead of "aux_" prefixed when possible.
.PP
.SS Colors
tmww defines colors depending on config option ANSICAPABLE. colors are
available then as \fIcolor_\fP prefix + color name, e.g. _color_red_.
.PP
.PP
Colors and highlight marker are hardcoded as terminal escape sequences.
.PP
.PP
.SH COPYRIGHT
This document is part of tmww - The Mana World Watcher scripts.
.PP
.PP
Licensed under terms of GNU General Public License version 3. For full text of
license see COPYING file distributed with tmww.
.PP
.PP
.SH AUTHORS
willee <v4r@trioptimum.com>, 2012-2014
.PP
.PP
.SH SEE ALSO
\fBtmww\fP(1), \fBtmww-config\fP(5)
.PP
